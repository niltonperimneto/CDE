
# Configuring Session Manager


Session Manager is responsible for starting the desktop and automatically
saving and restoring running applications, colors, fonts, mouse behavior, audio
volume, and keyboard click.

Using Session Manager, you can:

Customize the initial session for all desktop users

Customize the environment and resources for all desktop users

Change the session startup message

Change parameters for session startup tools and daemons

Customize desktop color usage for all users










# What Is a Session?Session Managerintroductionsessiondefinition


A session is the collection of applications, settings, and resources present on
the user's desktop. Session management is a set of conventions and protocols
that enables Session Manager to save and restore a user's session. A user is able
to log into the system and be presented with the same set of running
applications, settings, and resources as were present when the user logged off.
When a user logs into the desktop for the first time, a
default initial session is
loaded. Afterward, Session Manager supports the notion of a
current and a home session.sessiondefaultcurrent sessionsessioncurrentsessionhomehome session
# The Initial Sessionsessiondefaultsessioninitial


When a user logs into the desktop for the first time, Session Manager will
generate the user's initial session using system default values. By default, the
File Manager and Information Manager will start. The Information Manager displays
introductory information about the CDE desktop.
# Current Sessionsessioncurrentcurrent session


The user's running session is always considered the current session, whether
restored upon login from a saved home session, a saved current session, or the
system default initial session. Based on the user's Style Manager Startup
settings, when the user exits the session, Session Manager automatically saves
the current session. When the user next logs in to the desktop, Session
Manager restarts the previously saved current session, meaning that the
desktop will be restored to the same state as when the user last logged out.
# Home Sessionsessionhomehome session


You can also have the desktop restored to the same state every time the user
logs in, regardless of its state when the user logged out. The user can save the
state of the current session and then, using the Style Manager Startup settings,
have Session Manager start that session every time the user logs in.
# Display-Specific Sessionssessiondisplay-specific


To run a specific session for a specific display, a user can create a display-
specific session. To do this, the user can copy the`HomeDirectory`/.dt/sessionsdirectory to`HomeDirectory`/.dt/`display`, where`display`is the real, unqualified host name (for example,pablo:0is valid,pablo.gato.com:0orunix:0is not). When the user logs in on displaypablo:0, Session Manager will start that display-specific session.
# Starting a SessionsessionstartingSession ManagerstartingSession ManagerSee also, session


Session Manager is started through/usr/dt/bin/Xsession filestarting Session ManagerXsession. When the user
logs in using the Login Manager,Xsessionis started by default.

Optionally, the user can log in using the traditional character modegetty(getty)
login, and start Session Manager manually using tools that start an X server,
such asxinit. For example:xinit /usr/dt/bin/Xsession.
# When a Session Starts


When Session Manager is started, it goes through the following steps to start
the user's session:

Sources the`HomeDirectory`.dtprofile filesourcing in/.dtprofilescript

Sources theXsession.d directoryXsession.dscripts

Displays aSession Managerwelcome messagewelcome messagedisplayingwelcome message

Sets updesktop search pathsdesktop search paths

Gathers available applications

Optionally sources`HomeDirectory`.profile file[profile file]/.profileor`HomeDirectory`.login file[login file]/.login

Starts theToolTalkmessaging daemonToolTalk&reg;messaging daemon

Loadssessionresourcesresourcessessionsession resources

Starts thecolor servercolor server

Starts theWorkspace ManagerstartingWorkspace Manager

Starts the sessionapplicationsstarting at loginapplications

The following sections describe the steps listed above.
# Sourcing the .dtprofile Script.dtprofile filesourcing in


At session startup, theXsession fileXsessionscript sources the user's`HomeDirectory`environment variablesin .dtprofile/.dtprofilescript. The`HomeDirectory`/.dtprofilescript is a/bin/shor/bin/kshscript that enables users to set upenvironment variablesin .dtprofileenvironment
variables for their sessions. For more information on setting up environment
variables, see.

If the`HomeDirectory`/.dtprofilescript does not exist, such as when a user is
logging into the desktop for the first time,Xsessionwill copy the desktop
defaultsys.dtprofiletoshellpersonal customization`HomeDirectory`.dtprofile filecreating/.dtprofile.

environment variablesdefaultThe desktop default is/usr/dt/config/sys.dtprofilesys.dtprofile file. To customize theshellsystem-wide customizationsys.dtprofilescript, copysys.dtprofilefrom/usr/dt/configto/etc/dt/configand edit the new file.
# Sourcing Xsession.d ScriptsXsession.d directoryscripts in


After sourcing the`HomeDirectory`/.dtprofilescript, theXsessionscript
sources theXsession.dscripts. These scripts are used to set up additional
environment variables and start optional daemons for the user's session. The
defaultXsession.dscripts are:

0010.dtpaths

Documents customizable desktop search paths

0020.dtims

Starts optional input method server

0030.dttmpdir

Creates per-user, per-session temporary directory

0040.xmbind

Sets up$XMBINDDIRto desktop default

There may be additional vendor-specific scripts inXsession.d.

Xsessionfirst sources all files in the/usr/dt/config/Xsession.ddirectory, followed by those in the/etc/dt/config/Xsession.ddirectory.

The desktop defaultXsession.dscripts are located in the/usr/dt/config/Xsession.ddirectory. To customize anXsession.dscript, copy the script from/usr/dt/config/Xsession.dto/etc/dt/config/Xsession.dand edit the new file. You must have execute
permission to perform this task.Xsession.d directorycustomizing

Also, to haveXsessionautomatically source a script of your own, copy it to/etc/dt/config/Xsession.d.Xsession filesystem-wide customizationSession Managersystem-wide customization

When you modify or create anXsession.dscript, make sure that any
foreground commands you issue are of short duration, as the time taken by the
command will directly affect session startup time. If a foreground command
does not exit, the session startup will hang. Commands run in anXsession.dscript that you want to remain running for the duration of the session should
be run in the background.
# welcome messagedisplayingDisplaying the Welcome Message


After sourcing`HomeDirectory`/.dtprofileand theXsession.dscripts,Xsessiondisplays a welcome message that covers the screen. You can
customize the welcome message displayed, or turn off the message entirely.
Thedthelloclient is used to display the message.

welcome messagecustomizingTo alter the message text, change thedthellooptions by modifying thedtstart_hello[0]variable.

To changedtstart_hello[0],create an/etc/dt/config/Xsession.dscript that sets the new value. To display the message of the day for all users,
create an executableshorkshscript, for example/etc/dt/config/Xsession.d/myvars,and setdtstart_hello[0]as
follows:dtstart_hello[0]=&ldquo;/usr/dt/bin/dthello -file /etc/motd &amp;&ldquo;

Similarly, users can change the welcome message for their sessions by settingdtstart_hello[0]in`HomeDirectory`/.dtprofile.

To turn off the welcome message, setdtstart_hello[0]=&ldquo; &ldquo;.

For more information aboutdthello, see thedthelloman page.
# Setting Up the Desktop Search PathsSession Managersetting search pathssearch pathsset by Session Manager


The desktop search paths are created at login bydtsearchpathdtsearchpath. There are
two categories of environment variables used bydtsearchpath:

Input Variables

System-wide and personal environment variables
whose values are set by the system administrator or
end user.

Output Variables

Variables created and assigned values bydtsearchpath. The value of each variable is the
search path for the desktop session.

To alter the command-line options ofdtsearchpath, modify thedtstart_searchpathvariable. To change thedtstart_searchpath variabledtstart_searchpathvariable for all users, create an executableshorkshscript (for example/etc/dt/config/Xsession.d/myvars), and setdtstart_searchpathas
follows:dtstart_searchpath=&ldquo;/usr/dt/bin/dtsearchpath&ldquo;

Users can similarly change thedtsearchpathoptions for their own sessions
only by settingdtstart_searchpathin`HomeDirectory`/.dtprofile.

For more information aboutdtsearchpath, see.
For more information aboutdtsearchpathoptions, see thedtsearchpathman page.
# Gathering Available Applications


The next step after setting up the desktop search paths is to gather available
applications, usingdtappgather. To alter the command-line options ofApplication Managergathering applicationsSession Managergathering applicationsapplicationsgathered by Session Managerdtappgatherdtappgather, modify thedtstart_appgathervariable. To change thedtstart_appgather variabledtstart_appgathervariable for all users, create an executableshorkshscript (for example/etc/dt/config/Xsession.d/myvars), and setdtstart_appgatheras follows:dtstart_appgather=&ldquo;/usr/dt/bin/dtappgather &amp;&ldquo;

Users can similarly change thedtappgatheroptions for their own sessions
only by settingdtstart_appgatherin`HomeDirectory`/.dtprofile.

For more information aboutdtappgatheroptions, see thedtappgather(4)man page.
# Optionally Sourcing the .profile or .login Scriptenvironment variablessourcing in .login or .profileshellsourcing in .profile or .login.profile filesourcing in.login filesourcing in


Xsessionis able to source a user's traditional`HomeDirectory`/.profileor`HomeDirectory`/.loginscripts. By default this capability is disabled. To tellXsessionto source the.profileor.loginscript, setDTSOURCEPROFILE variableDTSOURCEPROFILEtotrue.

To changeDTSOURCEPROFILEfor all users, create an/etc/dt/config/Xsession.dscript that sets the new value. To setDTSOURCEPROFILEtotruefor all users, create an executableshorkshscript, for example/etc/dt/config/Xsession.d/myvars,and setDTSOURCEPROFILEas follows:DTSOURCEPROFILE=true

Users can similarly changeDTSOURCEPROFILEfor their own sessions by
settingDTSOURCEPROFILEtotruein`HomeDirectory`/.dtprofile.
# Starting the ToolTalk Messaging DaemonToolTalkmessaging daemon


The ToolTalk messaging daemon,ttsession, enables independent
applications to communicate with each other without having direct knowledge
of each other. Applications create and send ToolTalk messages to communicate
with each other.ttsessioncommunicates on the network to deliver
messages.

To alter the command-line options ofttsessionstartingttsession, modify thedtstart_ttsessionvariable. To change thedtstart_ttsession variabledtstart_ttsessionvariable
for all users, create an executableshorkshscript (for example/etc/dt/config/Xsession.d/`myvars`), and setdtstart_ttsessionas
follows:dtstart_ttsession=&ldquo;/usr/dt/bin/ttsession -s&ldquo;

Users can similarly change thettsessionoptions for their own sessions by
settingdtstart_ttsessionin`HomeDirectory`/.dtprofile.

For more information aboutttsessionoptions, see thettsessionman
page. For more information onttsession, seeGetting Started Using ToolTalk
Messaging.
# Starting the Session Manager ClientSession Managerclient


At this point,Xsessionstarts/usr/dt/bin/dtsession, which continues
the session startup process.
# Loading the Session ResourcesSession Managerloading resourcesresourcesloading


Session Manager uses the X serverRESOURCE_MANAGERproperty to make
desktop resources available to all applications. Session Manager loads theRESOURCE_MANAGERby:

Loading the system default resources

Merging any system-wide resources specified by the system administrator.

Merging any user-specified resources

The desktop default resources can be found in/usr/dt/config/`language`sys.resources fileresourcesdefault desktop/sys.resources. These resources will be made
available to each user's session via theRESOURCE_MANAGERproperty. This file
should not be edited, as it is overwritten upon subsequent desktop
installations.

You can augment the system default resources by creating/etc/dt/config/`language`sys.resources file/sys.resources. In this file, you can override
default resources or specify additional resources for all desktop users. Since
this file is merged into the desktop default resources during session startup,
only new or updated resource specifications should be placed in this file.
Resources specified in this file will be made available to each user's session
through theRESOURCE_MANAGERproperty. Resources specified in this file take
precedence over those specified in the desktop default resource file.

Users can augment the desktop default and system-wide resources using their`HomeDirectory`/.Xdefaultsfile. Resources specified in this file will be made
available to that user's session through theRESOURCE_MANAGERproperty.
Resources specified in this file take precedence over those specified in the
desktop default or system administrator resource files.

The X Toolkit Intrinsics utility specifies that it will load resources for an
application from eitherRESOURCE_MANAGER propertyRESOURCE_MANAGERor from`HomeDirectory`/.Xdefaults, but not both. Ordinarily, this would mean that
the user's`HomeDirectory`/.Xdefaults file would be ignored. However, Session
Manager accommodates`HomeDirectory`/.Xdefaults file[Xdefaults file].Xdefaultsby merging it into theRESOURCE_MANAGERat session startup as described above. If a user changes`HomeDirectory`/.Xdefaults, the changes will not be visible to new
applications until the user invokes the Reload Resources action. TheReload Resources actionReload
Resources action will instruct Session Manager to reload theRESOURCE_MANAGERwith the default, system-wide, and user-specified
resources. This makes changes to the system-wide and personal resource files
available to applications.

For more information see:



Thedtresourcesfile(4)man page
# Starting the Color Servercolor serverstarting


Session Manager serves as thecolor serverresourcescolor server for the desktop and provides the
following set ofdtsessionresources that can be used to configure it.

foregroundColorforegroundColor resource

Controls whether a pixel is allocated for the foreground
color

dynamicColordynamicColor resource

Specifies whether read-only colors are allocated

shadowPixmapsshadowPixmaps resource

Specifies whether colors are allocated for top shadow
or bottom shadow

colorUsecolorUse resource

Limits color allocation

writeXrdbColorswriteXrdbColors resource

Specifies whether the*backgroundand*foregroundresources are placed in the resource
database

You can set color server resources for all users by creating/etc/dt/config/`language`/sys.resourcesand specifying the color server
resources in that file.

Users can similarly set color server resources for their own sessions by
specifying color server resources in`HomeDirectory`/.Xdefaults.

For more information about setting color server resources, see.
# Starting Workspace ManagerWorkspace ManagerstartingSession Managerstarting Workspace Manager


Session Manager is responsible for starting Workspace Manager. By default/usr/dt/bin/Workspace Managerstartingdtwmis started. An alternate window manager can be specified
with thewmStartupCommand resourceWindow ManagerchangingwmStartupCommandresource.

You can specify an alternate window manager for all users by creating/etc/dt/config/`language`/sys.resourcesand specifying the full path
name and options for the window manager with theDtsession*wmStartupCommandresource in that file.

Users can similarly specify an alternate window manager for their own
sessions only by specifying theDtsession*wmStartupCommandresource in`HomeDirectory`/.Xdefaults.

For more information about the Window Manager, see.
# Starting the Session Applicationsapplicationsstarting at loginSession Managerstarting applications


At session startup, Session Manager will restart any applications that were
saved as part of the session. The system default set of applications to be
restored as part of the user's initial session can be found in/usr/dt/config/`language`/sys.session.
This file should not be edited as it
will be unconditionally overwritten upon subsequent desktop installations.

For more information, see thedtsessionfile(4)anddtsessiondb(4)man pages.sys.session file

A system administrator can replace the set of applications that are started as
part of the user's initial session by copying/usr/dt/config/`language`/sys.sessionto/etc/dt/config/`language`/sys.sessionand modifying the latter file.
Unlike the resource files, this file will be used as a complete replacement for
the desktop default file, so you can make a copy of the system default file and
make any necessary modifications.Session Managercustomizing application startup
# Additional Session Startup Customizations


This section covers:

Setting environment variables

Setting resources

Using display-dependent sessions

Running scripts at login

Recovering a back-up session
# To Set Environment Variablesenvironment variablessettingvariablesenvironment, See environment variables


environment variablessystem-wideTo set system-wide environment variables, create a file in the/etc/dt/config/Xsession.dXsession.d directorydirectory that sets andenvironment variablesexportingexports the
variable.

For example, if you create an executableshorkshscript,/etc/dt/config/Xsession.d/`myvars,`

containing:export MYVARIABLE=&ldquo;`value`&ldquo;

then the variableMYVARIABLEwill be set in each user's environment at the
next login.

environment variablespersonalTo set personal environment variables, set the variable in`HomeDirectory`.dtprofile filesetting environment variables in/.dtprofile.

For example:export MYVARIABLE=&ldquo;`value`&ldquo;

sets the variableMYVARIABLEin each user's environment at the next login.

Session Manager does not automatically read the.profile filenot read by Login Manager.profileor.login filenot read by Login Manager<$nopage>shellSee also environment variables, .profile, .login, .dtprofile.loginfile. However, it can be configured to use these files; see.
# To Set Resourcesresourcessetting


To set system-wide resources, add the resources to the file/etc/dt/config/`language`/sys.resources.
(You may have to create the file.)sys.resources file

..dtprofile filesyntaxdtprofileonly supports/bin/shor/bin/kshsyntax.

For example, if in/etc/dt/config/C/sys.resourcesyou specify:AnApplication*resource:`value`

then the resourceAnApplication*resourcewill be set in each user'sRESOURCE_MANAGERproperty at the next login.RESOURCE_MANAGER property

To set personal resources, add the resources to the file`HomeDirectory`/.Xdefaults.
# To Set Display-Specific Resourcesdisplay-specific resourcesresourcesdisplay-specific


You can set display-specific resources for all desktop users on the system. Also,
users can set display-specific resources limited to their own session. This
enables you to specify resources depending upon which display the user uses
to log in to the desktop.

To set display-specific resources for all desktop users on the system, create
the file/etc/dt/config/`language`/sys.resourcesthat specifies the
display-specific resources.

To set personal display-specific resources, specify the resource in`HomeDirectory`/.Xdefaults.

You delimit these resources by enclosing them incpp statementscppconditional statements.
ADISPLAY_displayname macroDISPLAY_displaynamemacro is defined depending upon the value of the$DISPLAYvariable. This is done by converting all. (period) and: (colon)
characters to _ (underscores), stripping off any screen specification, and finally
prefixingDISPLAY_to the result.

For example, a$DISPLAYof:0would beDISPLAY_0, and a$DISPLAYofblanco.gato.com:0.0would beDISPLAY_blanco_gato_com_0. The
resulting value can be used as part of acpptest in a session resource file. For
example, if in/etc/dt/config/C/sys.resourcesyou specify:Myapp*resource: value
#ifdef DISPLAY_blanco_gato_com_0
Myapp*resource: specialvalue1
#endif
#ifdef DISPLAY_pablo_gato_com_0
Myapp*resource: specialvalue2
#endif

the resourceMyApp*resourcewill be set inRESOURCE_MANAGERtospecialvalue1when the user logs in on displayblanco.gato.com:0;specialvalue2when the user logs in onpablo.gato.com:0;andvaluewhen the user logs in on another display.
# To Change Applications for the Initial Sessionsessionfirst


You can specify alternate applications to start as part of a user's initial session.

Copy/usr/dt/config/`language`/sys.sessionto/etc/dt/config/`language`/sys.session.

Modify the newsys.session filesys.sessionfile.

Each entry insys.sessionappears as:dtsmcmd -cmdcommand_and_optionsdtsmcmd command

To start an additional application as part of a user's initial session, specify a
newsys.sessionentry with a full path name. For example, to start/usr/bin/X11/xclockas part of a user's initial session, add anxclockentry to/etc/dt/config/C/sys.resources:#
# Start up xclock...
#
dtsmcmd -cmd &ldquo;/usr/bin/X11/xclock -digital&ldquo;
# To Set Up a Display-Specific Sessionsessiondisplay-specificdisplay-specific session


A user can set up a display-specific session to tune a session to a particular
display.

Copy the`HomeDirectory`/.dt/sessions directorysessionsdirectory to`HomeDirectory`/.dt/`display`where`display`is the real, unqualified host name
(pablo:0is valid,pablo.gato.com:0orunix:0is not).

For example, to create a display-specific session for displaypablo.gato.com:0:cp -r`HomeDirectory`/.dt/sessions`HomeDirectory`/.dt/pablo:0

When the user next logs in on displaypablo.gato.com:0, the Session
Manager will start that display-specific session.
# Executing Additional Commands at Session Startup and Logout


Users can specify that additional commands be started when they log in to
their desktop sessions. This is useful for setting up X settings that are not saved
by Session Manager. For example, the user can usexsetrootto customize the
root (workspace) pointer. Another use would be to start applications that are
unable to be saved and restored by Session Manager. If an application will not
restart when the session is restored, the user can start the client using this
method.
# To Execute Additional Commands at Session StartupSession Managerexecuting additional commandssessionexecuting commands at startup


Create the file`HomeDirectory`/.dt/sessions/sessionetccontaining the commands.sessionetc file

Generally this file is a script and must have execute permission. Processes
started insessionetcshould be run in the background.

Do not usesessionetcto start clients that are automatically restored
by Session Manager. Doing so can cause multiple copies of the application to
be started. You may not be able to see the copies immediately because the
windows may be stacked on top of one another.
# To Execute Additional Commands at Logoutsessionexecuting commands at logoutSession Managerexecuting commands at logout


A companion file tosessionetcissessionexit filesessionexit. Usesessionexitto
perform some operation at session exit that is not handled by Session Manager.

Create the file`HomeDirectory`/.dt/sessions/sessionexit.

Likesessionetc, this file is usually a script with execute permission.
# To Recover a Session from BackupsessionrecoveringSession Managerbacking up sessionssessionbackup


When Session Manager saves a session, the session information is stored in the`HomeDirectory`/.dt/sessionsdirectory or in the`HomeDirectory`/.dt/`display`directory if using a display-specific session. In these directories, Session
Manager creates a subdirectory namedcurrentorhometo store information
for the respective current or home session. Before the session information is
stored, Session Manager makes a backup of the prior session with that name
and stores it incurrent.old directorycurrent.oldorhome.old directoryhome.old.

Log in using the Failsafe Session or Command Line Login from the login
screen.

Copy the backup session directory to the active name. For example, to
recover the backup home session:cp -r`HomeDirectory`/.dt/sessions/home.old`HomeDirectory`/.dt/sessions/home

Display-specific sessions can be recovered in the same manner.
# To Investigate Session Startup ProblemsSession Managererror logSession Managertroubleshooting


Check the file`HomeDirectory`/.dt/startlog.startlog filesessionlogging errors

Thestartlogfile will contain the output (stderr)
from applications started by the Session Manager (on the Session Manager's host).
# Session Manager Files and Directoriesconfiguration filesSession ManagerSession ManagerfilesSession Managerdirectories


/usr/dt/bin/Xsession

/usr/dt/config/Xsession.d/*

/usr/dt/bin/dtsession

/usr/dt/bin/dtsession_res

`HomeDirectory`/.dt/sessions/current

`HomeDirectory`/.dt/sessions/home

`HomeDirectory`/.dt/`display`/current

`HomeDirectory`/.dt/`display`/home