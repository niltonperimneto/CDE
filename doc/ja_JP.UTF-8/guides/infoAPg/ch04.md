インフォメーション・ライブラリの構築インフォメーション・ライブラリ構築この章では、SGML ドキュメントを検証してインフォメーション・マネージャでブラウズ可能なライブラリを構築するためのdtdocbook2infolibサブコマンドの使用方法、およびブックケースのスタイル・シート情報を更新する方法について説明します。dtdocbook2infolib validateコマンドを使用して、SGML ブック・ドキュメントおよびブックケース規定を検証します。検証は、構築のための準備期間に有用です。インフォメーション・マネージャコマンドdtdocbook2infolib validatedtdocbook2infolib buildコマンドを使用して、SGML の検証実行はもとより、新規インフォメーション・ライブラリの構築、既存インフォメーション・ライブラリへのブックケース追加、および既存ライブラリの更新を行います。インフォメーション・マネージャコマンドdtdocbook2infolib buildインフォメーション・ライブラリを一度構築すれば、dtdocbook2infolib updateコマンドを使用して、ライブラリに関連するスタイル・シート情報を更新することができます。これらの手続きは、次で説明しています。インフォメーション・マネージャコマンドdtdocbook2infolib update「SGML ドキュメントの検証」「ライブラリのブックケースの構築、追加、および置換」「構築されたブックケースのスタイル・シートの更新」コマンドの構文およびこれらのコマンドの例については、dtdocbook2infolib(1)マニュアル・ページを参照してください。新規ライブラリ構築の前にインフォメーション・ライブラリ構築前提条件インフォメーション・マネージャの新規インフォメーション・ライブラリを構築する前に、次に示すことを行う必要があります。外部エンティティ参照をユーザのシステム・ファイルにマップするときに使用されるメソッドを指定します。次のうちのいずれかで行うことができます。外部エンティティ参照の適切な環境変数を設定します。dtdocbook2infolib buildコマンドの-mオプションを使用して、適切なカタログ・ファイルを指定します。必要な SGML 準拠ドキュメントがすべて揃っているか確認します。これには、ブックケースの各ブックのための文書型定義、ハイパーテキスト目次、およびスタイル・シートが含まれます。「dtdocbook2infolib validate の実行」で説明しているように、dtdocbook2infolib validateコマンドを使用して、SGML ドキュメントを検証することができます。「ライブラリのブックケースの構築、追加、およぴ更新」で説明しているように、dtdocbook2infolib buildのオプションを理解します。環境変数の設定環境変数ユーザが、SGML Open Technical Resolution 9401:1994の外部エンティティ参照に関する推奨を使用しているかどうかに依存して、以下の環境変数のひとつまたは両方を設定するか、dtdocbook2infolibコマンドの-mオプションを使用する必要があります。SGML_CATALOG_FILESSGML Open Technical Resolution 9401:1994の外部エンティティ管理に関連する推奨にしたがっている場合は、この環境変数を設定してください。この環境変数の値は、SGML エンティティ宣言の一覧表記とファイル・マッピング識別子があるcatalogまたはCATALOG（大文字、小文字どちらでも使用することができます）の位置を指定します。環境変数を設定しない場合は、適切なdtdocbook2infolibコマンドの-mオプションを使用して、パブリックな識別子とエンティティ名をシステム・ファイルにマップすることができます。
詳細については、catalog(5)マニュアル・ページを参照してください。SGML_PATH外部エンティティ参照をシステム・ファイルにマップするときに、この環境変数を設定します。詳細については、dtdocbook2infolib(5)マニュアル・ページを参照してください。関連情報については、以下に示す文献を参照してください。SGML Open Technical Resolution 9401:1994SGML ドキュメントの検証SGML ドキュメント検証インフォメーション・ライブラリを構築する前に、適切な文書型定義にしたがっているか確認するために、SGML ドキュメントを検証しなければなりません。dtdocbook2infolib validateインフォメーション・マネージャコマンドdtdocbook2infolib validateコマンドを使用して、ブックケース規定、個別のドキュメント、および他の SGML 準拠ドキュメントの SGML 検証を行うことができます。検証過程において、dtdocbook2infolib validateは、次に示すことを実行します。SGML にしたがっていることを検証するために、入力ドキュメントの文書型定義をチェックします。入力ドキュメントの SGML マークアップが、ドキュメントの文書型定義で定義されているマークアップ言語と整合性があることを検証します。無効なドキュメントを検出した場合には、dtdocbook2infolib validateプログラムによってエラー・メーセージが出力されます。インフォメーション・ライブラリを構築するときに使用されるファイルのエラーは、データが構築される前に、すべて修正されなければなりません。dtdocbook2infolib validate の実行インフォメーション・ライブラリドキュメントの検証次に示す例の基本的なコマンド行（これは、単一ブックケースのインフォメーション・ライブラリの検証を実行します）は、以下のとおりです。dtdocbook2infolib validate ch03.sgm ch04.sgm ch05.sgm以下に、引き数の説明を示します。ch03.sgm ch04.sgm ch05.sgm検証すべき SGML ドキュメントを指定します。dtdocbook2infolib validateコマンドは、いかなる有効な SGML 準拠ドキュメントに対しても実行することができます。ドキュメントが無効な場合は、エラー・メッセージが返されます。例のファイルch05.sgmに対して返されたエラーの型の例を、次に示します。これには、不足あるいは無効のエンティティ宣言があります。%:dtdocbook2infolib validatensgmls:ch05.sgm:12:1:E: cannot open "hal.gml" (No such file or directory)
nsgmls:ch05.sgm:20:1:E: general entity "tab" not defined and no default entity
..............................
..............................
..............................
dtdocbook2infolib: command failed: nsgmls -sg /usr/dt/infolib/C/SGML/dtinfo.decl ch05.sgm
ch05.sgmライブラリのブックケースの構築、追加、および置換インフォメーション・ライブラリ構築dtdocbook2infolib build本節では、ブックケースの新規インフォメーション・ライブラリへの構築、既存のインフォメーション・ライブラリへのブックケースの追加、および既存のライブラリのインフォメーション・データベースの更新を行うためのdtdocbook2infolib buildコマンドの使用方法について説明します。インフォメーション・マネージャコマンドdtdocbook2infolib build構築にあたって考慮することインフォメーション・ライブラリ構築にあたって考慮することブックとブックケースをいくつでも含むすべてのサイズのインフォメーション・ライブラリを構築することができます。次に示すインフォメーション・ライブラリ（これに限られるわけではありません）を構築することができます。ひとつまたは複数のブックから成る単一のブックケースそれぞれがひとつまたは複数のブックから成る複数のブックケースインフォメーション・ライブラリを設計するときには、インフォメーション・マネージャにおけるその表現とユーザによるその表示を考慮しなければなりません。多くのユーザは、オンラインのマニュアルに慣れていないかもしれないからです。インフォメーションの構造とインフォメーションの検索機能は、オンラインのインフォメーション・ライブラリの設計にあたって、もっとも重要な要素の一部です。ユーザが、容易に、ブックの構造を下ったり、ブックケースのブックを設定できるようにしなければなりません。さらに、明確なハイパーテキスト・リンクと効果的な検索機構によって、望む情報をすばやく見つけることができるようにしなければなりません。ライブラリの構成インフォメーション・マネージャには、非常に強力な検索機能があります。しかしながら、ユーザのインフォメーション・ライブラリの構成は、検索過程の効果に影響します。一般に、インフォメーション・ライブラリのブックケースが少ければ少いほど、また、各ブックケースに含まれるブックが少ければ少いほど、構築過程の進捗は高速になります。また、このようなインフォメーション・ライブラリ構造は、すばやく、容易に更新することができます。残念ながら、ブックケース数が増加すると、情報に関してその内容を検索するブラウザ機能については、このようなライブラリ構造は非効果的になります。その一方、その内容が相対的に大量のブックを含む少量のブックケースから構成されるインフォメーション・ライブラリは、構築とその後の更新により長い時間を要するようになります。しかし、このようなライブラリ構造の検索時間は、顕著に短縮されます。構築スペースインフォメーション・ライブラリを構築する前に、十分なスペースを構築過程が行われる適切な場所に確保しなければなりません。構築が完了すると、インフォメーション・ライブラリは、構築の元になったソースとほぼ同じ容量のスペースを占めます。しかしながら、構築過程そのものについては、一時的ファイルの記憶領域として、最大３倍の追加スペースが必要です。この追加スペースは、構築完了時に自動的に削除される一時的な構築スペースとして確保しなければなりません。一時的な構築スペースのデフォルトは、/usr/tmpに確保されます。/usr/tmpで使用可能なディスク・スペースが、元のドキュメント・ソースのサイズの３倍よりも小さい場合、dtdocbook2infolib buildコマンドの-Tオプションを使用して、一時的な構築ファイルのために別の場所を指定するか、TMPDIR環境変数を設定しなければなりません。インフォメーション・マネージャの現在のバージョンには、ユーザが同じインフォメーション・ライブラリの構築や修正を同時に行うことを回避する同時使用のロック機構がありません。dtdocbook2infolib buildコマンドを実行するときには、他のdtdocbook2infolibやインフォメーション・マネージャのプロセスが、インフォメーション・ライブラリにアクセスしないことを確認するため、事前に注意を払ってください。dtdocbook2infolibコマンドの同時使用は、インフォメーション・マネージャの失敗をもたらします。インフォメーション・ライブラリの編成インフォメーション・ライブラリを構築すると、ブラウザで表示可能なファイルが、図「構築ディレクトリ構造」で示される構造で編成されます。構築ディレクトリ構造構築ディレクトリ構造インフォメーション・マネージャの構築ディレクトリディレクトリ構造構築ディレクトリ構造を、以下に示します。BC.dbdこのファイルは、ブックケースBCのためのドキュメント・データベースです。これには、すべてのコンパイルされたテキスト、グラフィック、および表のデータが含まれます。BC.dbiこのファイルには、ブックケースBCのための索引データが含まれます。BC.schこのファイルには、データベースの構造が記述されています。dtsearchdirectoryこのディレクトリには、全文検索エンジンに関係するすべてのファイルが含まれます。bookcase.mapこのファイルは、ブックケースをライブラリ内に編成します。dtdocbook2infolib adminコマンドを使用して、このファイルを修正することができます。LIB.oliLIBのために使用される文字列は、ライブラリにそのファイル名を与えます。新規ライブラリの構築新規のインフォメーション・ライブラリ構築のための基本的なdtdocbook2infolib buildコマンド行の例を、次に示します。dtdocbook2infolib build-T/k1/local/daver/-lInfoLib1 DCE.bc INFOMGR.bc PROG.bc各オプションの意味を、以下に示します。-T/k1/local/daver構築過程で生成される一時的なファイルが置かれる場所を指定します。-lInfoLib1インフォメーション・ライブラリを含むディレクトリの名前を指定します。構築後、InfoLib1には、続くコマンド行の引き数で指定される３つのブックケースが含まれます。DCE.bc INFOMGR.bc PROG.bcブックケース規定ファイルのファイル名を指定します。各ブックケース規定には、構築されるひとつまたは複数のブックの名前が含まれます。コマンド行では、任意の数のブックケースのファイル名を指定することができます。dtdocbook2infolib buildコマンドは、ブックケース規定のそれぞれで指定されたドキュメントをブラウザで表示可能なフォーマットに変換し、それらを新規に作成されたインフォメーション・ライブラリのディレクトリInfoLib1に置きます。３つのブックケースの名前を（それぞれのブックケースの BOOKCASENAME 要素で指定されるように）それぞれDCE、INFOMGR、およびPROGとすると、InfoLib1ディレクトリ下に、ブックケースのディレクトリDCE、INFOMGR、およびPROGが生成されます。その一方、各ブックケースには、その BOOK 要素で指定されるドキュメント・データベース（ブック）が含まれます。図「新規ライブラリの作成」は、新規に構築されるInfoLib1ライブラリを示しています。新規ライブラリの作成既存ライブラリへのブックケース追加ブックケース追加dtdocbook2infolib buildインフォメーション・マネージャの新規インフォメーション・ライブラリ作成に加えて、dtdocbook2infolib buildを使用して、既存のインフォメーション・ライブラリにまだ構築されていないブックケースを追加することもできます。以下に示す例では、引き数-l&nbsp;InfoLib1が、新規のインフォメーション・ライブラリではなく、既存のインフォメーション・ライブラリの名前であることを仮定しています。dtdocbook2infolib build-lInfoLib1 ORA.bc以下に説明を示します。-lInfoLib1これは、既存のインフォメーション・ライブラリを含むディレクトリの名前です。ORA.bcこれは、その内容をInfoLib1インフォメーション・ライブラリに追加するブックケース規定ファイルの名前です。コマンド行では、任意の数のブックケース規定名を指定することができます。dtdocbook2infolib buildこれは、ブックケース規定ファイルORA.bcのブック・ドキュメントを、ブラウザで表示可能なフォーマットに変換し、それらを既存のインフォメーション・ライブラリのディレクトリInfoLib1に追加します。追加されるブックケースの名前を（その BOOKCASENAME 要素で指定されるように）ORAと仮定すると、InfoLib1ディレクトリには、ブックケースのディレクトリDCE、INFOMGR、PROGおよびORAが生成されます。図「既存のライブラリへのブックケース追加」は、更新されたInfoLib1ライブラリを示しています。追加されるブックケースは、インフォメーション・マネージャのブック・リスト中の既存のブックケースのリストの末尾に追加されます。dtdocbook2infolib adminコマンドを使用して、構築後にリストの再調整を行うことができます。dtdocbook2infolib(1)マニュアル・ページを参照してください。既存のライブラリへのブックケース追加既存のライブラリのブックケースの置換ブックケース置換dtdocbook2infolib buildインフォメーション・ライブラリの作成および既存のライブラリへのブックケース追加に加えて、dtdocbook2infolib buildコマンドで、ライブラリの指定されたブックケースを置換することもできます。以下に示す例では、dtdocbook2infolib buildプロセスが、ブックケースINFOMGRおよびPROGの再構築とInfoLib1インフォメーション・ライブラリにある同じ名前の既存ブックケースの上書きを行うために使用されています。dtdocbook2infolib build-lInfoLib1 INFOMGR.bc PROG.bc各オプションの説明を、以下に示します。-lInfoLib1これは、既存のインフォメーション・ライブラリがあるディレクトリの名前です。INFOMGR.bc PROG.bcこれは、その内容で、インフォメーション・ライブラリInfoLib1を更新するために再構築するブックケース規定ファイルのファイル名です。コマンド行では、任意の数のブックケース規定のファイル名を指定することができます。dtdocbook2infolib buildは、ブックケース規定ファイルINFOMGR.bcおよびPROG.bcのブックを再構築し、それらを既存のインフォメーション・ライブラリのディレクトリInfoLib1に置きます。そのブックケース名が（それぞれの BOOKCASENAME 要素で指定されているように）INFOMGRおよびPROGである新規に構築されたブックケースは、同じ名前をもつ既存のブックケースを上書きします。図「既存ライブラリのブックケースの置換」は、更新されたInfoLib1ライブラリを示しています。既存ライブラリのブックケースの置換構築されたブックケースのスタイル・シートの更新スタイル・シート更新インフォメーション・マネージャコマンドdtdocbook2infolib updateインフォメーション・マネージャでは、そのデータベースを再構築せずに、既存のブックケースのフォーマット指定を変更することができます。この機能によって、異なる読者や製造要件に合致するように、フォーマット属性を変更しなければならないブックを処理するときに、柔軟な対処が可能になります。dtdocbook2infolib updateコマンドを使用して、フォーマットを管理するスタイル・シート情報を更新することによって、既存のインフォメーション・ライブラリのブックの再フォーマットを行います。dtdocbook2infolib updateによって、スタイル・シートを更新してその変更の結果をすばやく確認したり、あるスタイル・シートを別のものに置き換えて関連するドキュメントの再フォーマットをすばやく行うことができます。dtdocbook2infolib updateを実行すると、スタイル・シートの変更によって影響を受けるドキュメントあるいはドキュメントのセクションのみが再フォーマットされます。dtdocbook2infolib updateを実行して、インフォメーション・ライブラリのドキュメントを再フォーマットする前に、次のことを行います。スタイル・シートに対して行った変更が有効なものであることを確認します。dtdocbook2infolib updateコマンドは、更新過程において、スタイル・シートのファイルを検証します。dtdocbook2infolib updateを実行するときに、外部エンティティ参照を処理するための適切な環境変数の設定、あるいは、-mオプションの使用による適切なカタログ・ファイルの指定を行います。スタイル・シートを更新しているときには、インフォメーション・マネージャやdtdocbook2infolib adminプロセスを実行してはいけません。dtdocbook2infolib update の実行次に示す例の基本的なコマンド行は以下のとおりです。この例は、指定されたスタイル・シートを使用するドキュメントあるいはドキュメントのセクションを再フォーマットするものです。dtdocbook2infolib update-lInfoLib1-bINFOMGR style1.sty各オプションの意味を、以下に示します。-lInfoLib1これは、既存のインフォメーション・ライブラリがあるディレクトリの名前です。-bINFOMGRこれは、指定されたスタイル・シートで再フォーマットされるセクションを含むブックケースの名前（その BOOKCASENAME 要素で指定されているように）です。style1.styこれは、dtdocbook2infolib updateのプロセスにおいて、適用されるスタイル・シートのファイル名です。使用するスタイル・シートは、「インフォメーション・マネージャのスタイル・シートの理解」で説明しているようにStyleSheet.dtdに準拠していなければなりません。dtdocbook2infolib updateのプロセスを実行した後、変更の効果を確認するために、インフォメーション・マネージャのブック・リスト・ウィンドウを使用してインフォメーション・ライブラリを開くことができます。関連情報については、以下を参照してください。dtdocbook2infolib(1)マニュアル・ページ「ブックケース規定の作成」「スタイル・シートの使用」「インフォメーション・マネージャのスタイル・シートの理解」