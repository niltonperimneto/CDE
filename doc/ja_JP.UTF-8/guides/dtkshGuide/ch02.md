スクリプト例スクリプトスクリプト例スクリプト例この章は、1章で学んだdtkshの使用方法を説明します。
ここに記述されている2つの簡単なスクリプトは、独自のスクリプトを記述しはじめる際に、
よい参考になります。スクリプトの記述スクリプト記述このスクリプトは、プッシュ・ボタン・ウィジェットを置いたブリテン・ボード・ウィジェット
を作成しています。スクリプトは、コールバックを含まない簡単なものです。2つめの
スクリプトにはコールバックが含まれています。1つめのスクリプトは次のとおりです。#!/usr/dt/bin/dtksh
XtInitialize TOPLEVEL dttest1 Dtksh $0XtInitializeXtSetValues $TOPLEVEL title:&ldquo;dttest1&rdquo;XtSetValuesXtCreateManagedWidget BBOARD bboard XmBulletinBoard $TOPLEVEL \
   resizePolicy:RESIZE_NONE height:150 width:250\
   background:SkyBlueXtCreateManagedWidgetXtCreateManagedWidget BUTTON pushbutton XmPushButton $BBOARD \XtCreateManagedWidgetbackground:goldenrod \
   foreground:MidnightBlue \
   labelString:&rdquo;Push Here&rdquo; \
   height:30 width:100 x:75 y:60 shadowThickness:3
XtRealizeWidget $TOPLEVELXtRealizeWidgetXtMainLoopXtMainLoop図2-1に1つめのスクリプトが生成するウィンドウを示します。dttestスクリプトのウィンドウスクリプトの1行めは次のとおりです。#!/usr/dt/bin/dtkshこれは、標準的なシェルではなく、/usr/dt/bin/dtkshを使用してスクリプトを実行することを、
オペレーティング・システムに指示します。次の行はXtイントリンシクスを初期化しています。初期化XtInitialize TOPLEVEL dttest1 Dtksh $0トップレベル・ウィジェットウィジェットトップレベル・ウィジェットトップレベル・ウィジェットの名前は環境変数$TOPLEVELに保存され、シェル・ウィジェット
の名前はdttest1、アプリケーション・クラス名はDtksh、そしてアプリケーション名はdtksh変数$0であることを表しています。次の行は、タイトル・リソースにスクリプト名を設定しています。XtSetValues $TOPLEVEL title:&rdquo;dttest1&rdquo;リソース名(タイトル)の終りにあるコロンとその値の間にスペースは入りません。
スペースが入っていると、エラー・メッセージが表示されます。次の4行で、ブリテン・ボードウィジェットブリテン・ボードブリテン・ボード・ウィジェットを作成し、いくつかのリソースを設定します。XtCreateManagedWidget BBOARD bboard XmBbulletinBoard $TOPLEVEL \
  resizePolicy:RESIZE_NONE \
  background:SkyBlue\
  height:150 width:250ブリテン・ボード・ウィジェットのIDは環境変数$BBOARDに保存されます。
ウィジェットの名前はbboardです。この名前は、Xtイントリンシクスで、外部の
リソース・ファイルでリソースの値を設定する際に使用します。ウィジェット・クラスは、XmBulletinBoardです。ブリテン・ボードの親ウィジェットは、環境変数$TOPLEVELに登録されているウィジェットIDです。
これは、最初の行の初期化コマンドで生成したトップレベル・ウィジェットです。行の
終りにある\(バックスラッシュ)は、このコマンドが次の行に続いていることを、dtkshに指示しています。次の6行はブリテン・ボード・ウィジェットの子としてプッシュ・ボタンウィジェットブリテン・ボードプッシュ・ボタン・ウィジェット
を作成し、いくつかのプッシュ・ボタンのリソースを設定します。XtCreateManagedWidget BUTTON pushbutton XmPushButton $BBOARD \
  background:goldenrod \
  foreground:MidnightBlue \
  labelString:&rdquo;Push Here&rdquo;\
  height:30 width:100 x:75 y:60\
  shadowThickness:3これは、変数、名前、クラス、親が異なっていることを除いて、基本的には、ブリテン
・ボードの作成に使用したプロシージャと同じです。次の行で、トップレベル・ウィジェットとそのすべての子を実現します。XtRealizeWidget $TOPLEVELXtrealizeWidget最後に、XtMainLoopXtMainLoopコマンドが、ウィジェットのためのイベントのループ処理を
開始します。XtMainLoopこのスクリプトで、ウィンドウがディスプレイに表示されます。ウィンドウ・マネージャで[閉じる]を選択するか、またはスクリプトを実行した端末ウィンドウで[CTRL]+[C]キーを
押して、このスクリプトを終了するまで、ウィンドウは表示されたままの状態になります。コールバックの追加コールバックプッシュ・ボタンが押されたときに、端末ウィンドウにメッセージを表示し、スクリプト
が終了するプッシュ・ボタンの機能を提供するには、コールバックを追加する必要が
あります。そして、このコールバックの存在をプッシュ・ボタンに指示する必要もあり
ます。新規コードを追加したスクリプトは次のとおりです。#!/usr/dt/bin/dtksh

activateCB() {
 echo &ldquo;Pushbutton activated; normal termination.&rdquo;
 exit 0
}

XtInitialize TOPLEVEL dttest2 Dtksh $0
XtSetValues $TOPLEVEL title:&rdquo;dttest2&rdquo;
XtCreateManagedWidget BBOARD bboard XmBulletinBoard $TOPLEVEL \
  resizePolicy:RESIZE_NONE \
  background:SkyBlue \
  height:150 width:250
XtCreateManagedWidget BUTTON pushbutton XmPushButton $BBOARD \
  background:goldenrod \
  foreground:MidnightBlue \
  labelString:&rdquo;Push Here&rdquo;\
  height:30 width:100 x:75 y:60 shadowThickness:3

XtAddCallback $BUTTON activateCallback activateCB
XtRealizeWidget $TOPLEVEL
XtMainLoopコールバックは関数activateCB()です。通常、プッシュ・ボタン
を作成した後、プッシュ・ボタンに対するコールバックを追加します。XtAddCallback $BUTTON activateCallback activateCBプッシュ・ボタンはコールバックを認識します。プッシュ・ボタンがクリックされたとき、activateCB()関数が実行され、&ldquor;Pushbutton activated; normal termination.&rdquor;
というメッセージが、スクリプトを実行した端末ウィンドウに表示されます。スクリプトは、
関数exit 0を呼び出すことによって、終了します。